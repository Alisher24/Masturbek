{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Страница рецепта</title>
  <link rel="stylesheet" href="{% static 'css/bootstrap-reboot.min.css'%}">
  <link rel="stylesheet" href="{% static 'css/bootstrap-grid.min.css'%}">
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css'%}">
  <link rel="stylesheet" type="text/css" href="{% static 'css/style.css'%}"/>
  <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>

</head>
<body>
<a href=".." class="LogoInProfile"><img src="{% static 'icons/logo.jpg'%}" alt="лого"></a>
<header class="HeaderOfRecipePage">
  <div class="RecipeBlock">
    <div class="RecipeBlock_Img">
      <img src="{{ recipe.photo.url }}" alt="Фото рецепта">
    </div>
    <div class="RecipeBlock_ShortInfo">
      <h2>{{ recipe.title }}</h2>
      <ul>
        <li><b>Категория:</b> <span>{{ recipe.category }}</span></li>
        <li><b>Автор:</b> <span>{{ user.username }}</span></li>
        <li><b>Дата публикации:</b> <span>{{ recipe.publication_date }}</span></li>
      </ul>
      <div class="RecipeBlock_ShortInfo_Statistics">
        <div class="RecipeBlock_ShortInfo_Statistics_Likes">
          <p><b>{{ recipe.likes_count }}</b></p>
            {% if recipe.is_liked %}
            <img src="{% static 'icons/Active heart.png' %}" alt="картинка лайка"
                class="like-image {{ heart_style }}" data-recipe-id="{{ recipe.id }}">
            {% else %}
            <img src="{% static 'icons/heart.png' %}" alt="картинка лайка"
                class="like-image {{ heart_style }}" data-recipe-id="{{ recipe.id }}">
            {% endif %}
        </div>
        <div class="RecipeBlock_ShortInfo_Statistics_Comments">
          <p><b>{{ recipe.comments_count }}</b></p>
          <img src="{% static 'icons/speech-bubble.png' %}" alt="картинка комментариев">
        </div>
        <div class="RecipeBlock_ShortInfo_Statistics_Saves">
            <p><b>{{ recipe.saves_count }}</b></p>
            {% if recipe.is_saved %}
            <img src="{% static 'icons/Active save-instagram.png'%}" alt="картинка сохранения"
                class="save-image {{ save_style }}" data-recipe-id="{{ recipe.id }}">
            {% else %}
            <img src="{% static 'icons/save-instagram.png'%}" alt="картинка сохранения"
                class="save-image {{ save_style }}" data-recipe-id="{{ recipe.id }}">
            {% endif %}
        </div>
      </div>
    </div>

  </div>
</header>
<section class="Descr">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="RecipeBlock_FullText">
                    <h2>Описание</h2>
                    <div class="RecipeBlock_BlockText">
                        {{ recipe.description }}
                    </div>  <!-- Здесь выводится полный текст рецепта -->
                </div>
            </div>
        </div>
    </div>
</section>
<section class="Coments">
  <div class="container">
  {% load cache %}
  {% cache 60 sidebar %}
    <div class="row">
        <div class="Coments_Header">
          <h2>КОММЕНТАРИИ</h2>
        </div>
        <div class="Coments_Block">
          <div class="Coments_Block_Post">
            <form id="commentForm" data-url="{% url 'add_comment' %}" data-recipe_id="{{ recipe.id }}" method="POST">
              {% csrf_token %}
              <input type="text" name="userText" placeholder="Ваш текст">
              <button type="submit" class="PostСomment">ОСТАВИТЬ</button>
            </form>
          </div>
        </div>
        <hr>
        <div id="commentsList">
          {% for comment in comments %}
            <div class="Coments_Coment" data-comment-id="{{ comment.id }}">
              <img src="{{ comment.user.photo.url }}" alt="аватарка">
              <div class="Coments_UserTextBlock">
                <p><b>{{ comment.user.username }}</b></p>
                <p class="ComentText">{{ comment.text }}</p>
                <p class="ComentData">{{ comment.created_at }}</p>
              </div>
            </div>
          {% endfor %}
        </div>
    </div>
  {% endcache %}
  </div>
</section>
<script src="{% static 'js/likes_coments_saves.js' %}"></script>
</body>
</html>